# Uploads directory â€“ allow image serving but BLOCK PHP execution.
# This prevents a malicious file disguised as an image from running as PHP.
# Security: even if an attacker bypasses MIME/extension checks, PHP will
# not interpret uploaded files as code.

Options -Indexes -ExecCGI

<IfModule mod_php.c>
    php_flag engine off
</IfModule>

<IfModule mod_php8.c>
    php_flag engine off
</IfModule>

<FilesMatch "\.php[s5]?$">
    <IfModule mod_authz_core.c>
        Require all denied
    </IfModule>
    <IfModule !mod_authz_core.c>
        Order deny,allow
        Deny from all
    </IfModule>
</FilesMatch>

# Only serve image types
<FilesMatch "\.(jpg|jpeg|png|gif|webp)$">
    <IfModule mod_authz_core.c>
        Require all granted
    </IfModule>
</FilesMatch>
